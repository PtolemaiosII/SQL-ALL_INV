SELECT
	M.DATECREATED AS DATECREATED,
	M.MEMO AS MEMO,
	M.RECORDID AS RECORDID,
	M.TABLEID AS TABLEID,
	M.USERNAME AS USERNAME,
	COUNT(M2.DATECREATED)+1 AS RANK,
	T.TABLEREFNAME AS TABLENAME
	--COALESCE(PART.NUM, '')  AS PART_NUM,
	--COALESCE(PO.NUM, '')  AS PO_NUM
FROM
	MEMO AS M
	LEFT OUTER JOIN MEMO AS M2 ON (M2.RECORDID = M.RECORDID AND M2.DATECREATED > M.DATECREATED)
	INNER JOIN TABLEREFERENCE AS T ON M.TABLEID = T.TABLEID
	--LEFT OUTER JOIN PART ON (PART.ID = M.RECORDID AND M.TABLEID = -2003201472)
	--LEFT OUTER JOIN PO ON (PO.ID = M.RECORDID AND M.TABLEID = 397076832)
GROUP BY 1,2,3,4,5,7
--HAVING COUNT(M2.DATECREATED) < 50 /*REPLACE THIS INTEGER BY YOUR PARAMETER*/
ORDER BY RANK ASC
