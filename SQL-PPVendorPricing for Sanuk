SELECT
	PART.NUM AS "PartNumber",
	PART.DESCRIPTION AS "PartDescription",
	PART.DETAILS AS "PartDetails",
	UOM.CODE AS "UOM",
	PART.UPC AS "UPC",
	PART.TYPEID AS "PartTypeID",
	IIF(PART.ACTIVEFLAG = 1, 'TRUE', 'FALSE') AS "Active",
	TAXRATE.CODE AS "PartTaxCode",
	PART.STDCOST AS "StdCost",
	-- Insert Tracking Info --
	MAX(IIF((PARTTOTRACKING.PARTTRACKINGID = 1), 'TRUE', 'FALSE')) AS "Track-Lot Number",
	-- Inserted --
	ASSETAC.NAME AS "AssetAccount",
	COGSAC.NAME AS "COGSAccount",
	ADJUSTMENTAC.NAME AS "AdjustmentAccount",
	SCRAPAC.NAME AS "ScrapAccount",
	VARIANCEAC.NAME AS "VarianceAccount",
	PART.ABCCODE AS "ABCCode",
	PART.WEIGHT AS "Weight",
	WUOM.CODE AS "WeightUOM",
	PART.WIDTH AS "Width",
	PART.HEIGHT AS "Height",
	PART.LEN AS "Len",
	SUOM.CODE AS "SizeUOM",
	-- Insert Custom Field Info --
	MAX(IIF((CustomVarCharLong.CUSTOMFIELDID = 31), CustomVarCharLong.info, NULL)) AS "CF-Fabric Fiber Content",
	MAX(IIF((CustomVarChar.CUSTOMFIELDID = 24), CustomVarChar.info, NULL)) AS "CF-Fabric GSM Edge",
	IIF(MAX(IIF((CustomInteger.CUSTOMFIELDID = 25), CustomInteger.info, NULL)) = 1, 'TRUE', 'FALSE') AS "CF-Dev Fabric",
	IIF(MAX(IIF((CustomInteger.CUSTOMFIELDID = 28), CustomInteger.info, NULL)) = 1, 'TRUE', 'FALSE') AS "CF-OPP Fabric",
	MAX(IIF((CustomDecimal.CUSTOMFIELDID = 30), CustomDecimal.info, NULL)) AS "CF-MOQ",
	MAX(IIF((CustomSet.CUSTOMFIELDID = 21), CustomSet.info, NULL)) AS "CF-Style Fabric content",
	MAX(IIF((CustomVarCharLong.CUSTOMFIELDID = 26), CustomVarCharLong.info, NULL)) AS "CF-Style Group Description",
	-- Inserted
	PRODUCT.NUM AS "ProductNumber",
	PRODUCT.DESCRIPTION AS "ProductDescription",
	PRODUCT.DETAILS AS "ProductDetails",
	PRODUCT.PRICE AS "Price",
	PRODUCT.SKU AS "ProductSKU",
	PRODUCT.UPC AS "ProductUPC",
	IIF(PRODUCT.ACTIVEFLAG = 1, 'TRUE', 'FALSE') AS "ProductActive",
	PROTAXRATE.CODE AS "ProductTaxCode",
	PRODUCT.DISPLAYTYPEID AS "ProductSOItemTypeID",
	INCOME.NAME AS "IncomeAccount",
	VENDOR.NAME AS "Vendor",
	IIF(VENDORPARTS.DEFAULTFLAG = 1, 'TRUE' , 'FALSE') AS "DefaultVendor",
	VENDORPARTS.VENDORPARTNUMBER AS "VendorPartNumber",
	VENDORPARTS.LASTCOST AS "Cost",
	VUOM.CODE AS "VendorUOM",
	-- Insert Product Custom Field Info --
	MAX(IIF((PCustomVarChar.CUSTOMFIELDID = 23), PCustomVarChar.info, NULL)) AS "CFP-Group Description",
	MAX(IIF((PCustomSet.CUSTOMFIELDID = 27), PCustomSet.info, NULL)) AS "CFP-Fabric content"
	-- Inserted --
FROM
	PART
	LEFT OUTER JOIN UOM ON PART.UOMID = UOM.ID
	LEFT OUTER JOIN TAXRATE ON PART.TAXID = TAXRATE.ID
	LEFT OUTER JOIN PARTTOTRACKING ON PART.ID = PARTTOTRACKING.PARTID
	LEFT OUTER JOIN ASACCOUNT AS ASSETAC ON (PART.INVENTORYACCOUNTID = ASSETAC.ID AND PART.INVENTORYACCOUNTID <> 0)
	LEFT OUTER JOIN ASACCOUNT AS COGSAC ON (PART.COGSACCOUNTID = COGSAC.ID AND PART.COGSACCOUNTID <> 0)
	LEFT OUTER JOIN ASACCOUNT AS ADJUSTMENTAC ON (PART.ADJUSTMENTACCOUNTID = ADJUSTMENTAC.ID AND PART.ADJUSTMENTACCOUNTID <> 0)
	LEFT OUTER JOIN ASACCOUNT AS SCRAPAC ON (PART.SCRAPACCOUNTID = SCRAPAC.ID AND PART.SCRAPACCOUNTID <> 0)
	LEFT OUTER JOIN ASACCOUNT AS VARIANCEAC ON (PART.VARIANCEACCOUNTID = VARIANCEAC.ID AND PART.VARIANCEACCOUNTID <> 0)
	LEFT OUTER JOIN UOM AS WUOM ON PART.WEIGHTUOMID = WUOM.ID
	LEFT OUTER JOIN UOM AS SUOM ON PART.SIZEUOMID = SUOM.ID
	LEFT OUTER JOIN CustomDecimal ON PART.ID = CustomDecimal.RECORDID
	LEFT OUTER JOIN CustomInteger ON PART.ID = CustomInteger.RECORDID
	LEFT OUTER JOIN CustomSet ON PART.ID = CustomSet.RECORDID
	LEFT OUTER JOIN CustomVarChar ON PART.ID = CustomVarChar.RECORDID
	LEFT OUTER JOIN CustomVarCharLong ON PART.ID = CustomVarCharLong.RECORDID
	LEFT OUTER JOIN PRODUCT ON PART.ID = PRODUCT.PARTID
	LEFT OUTER JOIN TAXRATE AS PROTAXRATE ON PRODUCT.TAXID = PROTAXRATE.ID
	LEFT OUTER JOIN ASACCOUNT AS INCOME ON (PRODUCT.INCOMEACCOUNTID = INCOME.ID AND PRODUCT.INCOMEACCOUNTID <> 0)
	LEFT OUTER JOIN VENDORPARTS ON PART.ID = VENDORPARTS.PARTID
	LEFT OUTER JOIN VENDOR ON VENDOR.ID = VENDORPARTS.VENDORID
	LEFT OUTER JOIN UOM AS VUOM ON VENDORPARTS.UOMID = VUOM.ID
	LEFT OUTER JOIN CustomVarChar AS PCustomVarChar ON PRODUCT.ID = PCustomVarChar.RECORDID
	LEFT OUTER JOIN CustomSet AS PCustomSet ON PRODUCT.ID = PCustomSet.RECORDID
WHERE
	PART.ACTIVEFLAG = 1
GROUP BY
	PART.NUM,
	PART.DESCRIPTION,
	PART.DETAILS,
	UOM.CODE,
	PART.UPC,
	PART.TYPEID,
	PART.ACTIVEFLAG,
	TAXRATE.CODE,
	PART.STDCOST,
	ASSETAC.NAME,
	COGSAC.NAME,
	ADJUSTMENTAC.NAME,
	SCRAPAC.NAME,
	VARIANCEAC.NAME,
	PART.ABCCODE,
	PART.WEIGHT,
	WUOM.CODE,
	PART.WIDTH,
	PART.HEIGHT,
	PART.LEN,
	SUOM.CODE,
	PRODUCT.NUM,
	PRODUCT.DESCRIPTION,
	PRODUCT.DETAILS,
	PRODUCT.PRICE,
	PRODUCT.SKU,
	PRODUCT.UPC,
	PRODUCT.ACTIVEFLAG,
	PROTAXRATE.CODE,
	PRODUCT.DISPLAYTYPEID,
	INCOME.NAME,
	VENDOR.NAME,
	VENDORPARTS.DEFAULTFLAG,
	VENDORPARTS.VENDORPARTNUMBER,
	VENDORPARTS.LASTCOST,
	VUOM.CODE
