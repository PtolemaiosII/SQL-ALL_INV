SELECT
DISTINCT
	PRODUCT.NUM,
	"SKU".PARTID,
	"SKUTOCOMPONENT".NUM,
	"COMPONENT".PARTID,
	"COMPONENTTOPART".NUM,
	'ftp://files.pureandco.com/' || REPLACE("COMPONENTTOPART".NUM, ' ', '%20') AS FTPPATH
FROM
	PRODUCT
	INNER JOIN PART ON PRODUCT.PARTID = PART.ID
	LEFT OUTER JOIN BOMITEM AS "SKU" ON "SKU".PARTID = PART.ID AND "SKU".TYPEID = 20
	LEFT OUTER JOIN BOM AS "SKUTOCOMPONENT" ON "SKUTOCOMPONENT".ID = "SKU".BOMID
	LEFT OUTER JOIN BOMITEM AS "COMPONENT" ON "COMPONENT".BOMID = "SKUTOCOMPONENT".ID AND "COMPONENT".TYPEID = 10
	LEFT OUTER JOIN BOMITEM AS "COMPONENT2" ON "COMPONENT".PARTID = "COMPONENT2".PARTID AND "COMPONENT2".TYPEID = 20
	LEFT OUTER JOIN BOM AS "COMPONENTTOPART" ON "COMPONENTTOPART".ID = "COMPONENT2".BOMID
WHERE
	PRODUCT.NUM LIKE 'SMU-341'
	AND
	"COMPONENTTOPART".NUM LIKE 'TEST%'
