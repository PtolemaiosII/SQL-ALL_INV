CREATE VIEW RANKED_MEMO_PO_PART (DATECREATED,MEMO,RECORDID,TABLEID,USERNAME,RANK,TABLENAME,NUM) AS  
   SELECT
	M.DATECREATED AS DATECREATED,
	M.MEMO AS MEMO,
	M.RECORDID AS RECORDID,
	M.TABLEID AS TABLEID,
	M.USERNAME AS USERNAME,
	COUNT(M2.DATECREATED)+1 AS RANK,
	T.TABLEREFNAME AS TABLENAME,
	COALESCE(PO.NUM, PART.NUM) AS NUM
FROM
	MEMO AS M
	LEFT OUTER JOIN MEMO AS M2 ON (M2.RECORDID = M.RECORDID AND M2.DATECREATED > M.DATECREATED)
	INNER JOIN TABLEREFERENCE AS T ON M.TABLEID = T.TABLEID
	LEFT OUTER JOIN PART ON (PART.ID = M.RECORDID AND M.TABLEID = -2003201472)
	LEFT OUTER JOIN PO ON (PO.ID = M.RECORDID AND M.TABLEID = 397076832)
GROUP BY 1,2,3,4,5,7,8

ORDER BY RANK ASC;
